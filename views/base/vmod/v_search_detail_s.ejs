<!doctype html><!-- vmod_detail_kiso : 基礎語彙の学習の詳細ページ -->
<html lang="jp">
<head>
  <%- include('../partials/v_head') %>
</head>
  <body>
    <header><%- include('../partials/header') %></header>
    <main class="container main">
      <div class="row">
        <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
          <ol class="breadcrumb bg-secondary top-bread">
            <li class="breadcrumb-item"><a href="/voca/" class="first-item">東外大言語モジュール top(Node版)</a></li>
            <li class="breadcrumb-item active"><a href="/voca/<%- lg %>/v/"><%= lang_jp %></a></li>
            <li class="breadcrumb-item active">語彙モジュール</li>
          </ol>
        </nav>
          <%- include('../partials/v_sidebar') %>
        <div class="col main-body">
          <div class="card">
            <div class="card-header">
              <h4 class="card-title">語彙詳細</h4>
            </div>
          </div>
          <div class="row">
            <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
              <ol class="breadcrumb bg-secondary">
                <li class="breadcrumb-item active" aria-current="page"><a href="./v_search" class="first-item">検索</a></li>
                <li class="breadcrumb-item active"><a href="" id="search-link"><span id="search-type"></span>：<%= targetChar %></a></li>
                <li class="breadcrumb-item active"><strong class="targetWord"></strong></li>
              </ol>
            </nav>
            <div class="">
              <p class="float-end"><span id="now_item">今</span>/<span id="all_items"></span>ページ</p>
            </div>
            <div class="container">
              <button type="button" name="button" class="btn btn-outline-primary col-auto btn_previous">　前　</button>
              <button type="button" name="button" class="btn btn-outline-primary col-auto btn_next">　次　</button>
            </div>
            <div class="link-explanation row align-items-center">
              <span class="col-auto col-auto"><span class="linkicon badge bg-info text-dark">文</span> 文法モジュールへリンク</span>
              <span class="col-auto col-auto"><span class="linkicon badge bg-success">会</span> 会話モジュールへリンク</span>
              <span class="col-auto col-auto"><span class="linkicon badge bg-warning text-dark">発</span> 発音モジュールへリンク</span>
            </div>
            <div class="result-area container">
              <div class="row align-items-center justify-content-center">
                <h3 class="targetWord col-auto"></h3>
                <div class="col-auto targetWordAudio"></div>
              </div>
              <hr class="featurette-divider">
              <div class="result-card-area">
              </div>
              <div class="container text-center button-area">
                <button type="button" name="button" class="btn btn-outline-primary col-auto float-start btn_previous">　前　</button>
                <a href="" class="linkToBefore">戻る</a>
                <button type="button" name="button" class="btn btn-outline-primary col-auto float-end btn_next">　次　</button>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div class="push"></div>
    <footer><%- include('../partials/footer') %></footer>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="../../js/make_detail_deco.js"></script>
    <script>
    var targetArray = <%- JSON.stringify(targetObj) %>;
    var targetChar = "<%= targetChar %>";
      if (targetChar.includes("~")) {
        $("#search-type").text("単語検索")
        var char = targetChar.replace(/~/g, "")
        $("#search-link").attr("href", `./v_search_list-str=${char}&st=<%= targetSt %>`)
        $(".linkToBefore").attr("href", `./v_search_list-str=${char}&st=<%= targetSt %>`)
      } else {
        $("#search-type").text("文字検索")
        $("#search-link").attr("href", "./v_search_list-char=<%= targetChar %>")
        $(".linkToBefore").attr("href", "./v_search_list-char=<%= targetChar %>")
      }
    var targetIndex = "";
    var targetItems;
    $("#all_items").text(targetArray.length)
    for (var i = 0; i < targetArray.length; i++) {
      if (targetArray[i].midasi == "<%= targetWord %>") {
        targetIndex = i
      }
    }
      showResult("<%= lg %>", targetIndex, "<%= targetWord %>")
      $(".btn_previous").click(function(){
        $(".btn_next").prop("disabled", false);
        targetIndex = targetIndex-1
        $(".targetWordAudio").empty();
        if (targetIndex >= 0) {
          $(".result-card-area").empty()
          showResult("<%= lg %>", targetIndex, "<%= targetWord %>");
        }
      });
      $(".btn_next").click(function(){
        $(".btn_previous").prop("disabled", false);
          targetIndex = targetIndex+1
          $(".targetWordAudio").empty();
          if (targetIndex < targetArray.length) {
            $(".result-card-area").empty()
            showResult("<%= lg %>", targetIndex, "<%= targetWord %>");
          }
      });
      let windowWidth = $(window).width()
      if (windowWidth < 767) {
        $(function(){
          $("#v_sidebar").before($(".main-body"));
        });
      }
      $(document).on('click', '.soundAria', function(){
        var mod = $(this).attr("class");
        var audio;
        switch (true) {
          case mod.includes("gmodsound"):
            audio = $(this).find(".gmodaudio")[0];
            audio.play();
          break;
          case mod.includes("vmodsound"):
            audio = $(this).find(".vmodaudio")[0];
            audio.play();
            break;
           case mod.includes("pmodsound"):
            audio = $(this).find(".pmodaudio")[0];
            audio.play();
            break; 
          case mod.includes("wordsound"):
            audio = $(this).find(".basicaudio")[0];
            audio.play();
            break;
          default:
            break
        }
      });

      var dmodAudioObj;
      function playDmodSound(dmodsound, startTime, stopTime){
        if(dmodAudioObj != null)dmodAudioObj.pause();
        dmodAudioObj = new Audio(dmodsound);
        dmodAudioObj.currentTime = startTime;
        dmodAudioObj.addEventListener("timeupdate", function (){
          if (stopTime != 0 && dmodAudioObj != null && stopTime < dmodAudioObj.currentTime){
            dmodAudioObj.pause();
            dmodAudioObj.removeEventListener("timeupdate",this);
            dmodAudioObj=null;
                return;
          }
        });
        dmodAudioObj.play();
      }
    </script>
    <style>
      .token {
        color: red;
        font-weight: bolder;
      }
      .btn_previous:disabled, .btn_next:disabled{
        background-color: gray;
        color: white;
        border: black;
      }
      .result-card {
        margin-top: 0px;
      }
      .button-area {
        padding-bottom: 80px;
      }
      .link-explanation{
        padding-top: 10px;
        padding-bottom: 10px;
      }
      .linkicon {
        padding-top: 8px;
        padding-bottom: 8px;
      }
    </style>
  </body>
</html>
