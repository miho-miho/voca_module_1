<!doctype html><!-- vmod_detail0 : 分類表の詳細ページ -->
<html lang="jp">
  <head><%- include('../partials/v_head') %></head>
  <body>
  <header><%- include('../partials/header') %></header>
    <main class="container main">
      <div class="row">
        <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
          <ol class="breadcrumb bg-secondary top-bread">
            <li class="breadcrumb-item"><a href="/voca/" class="first-item">東外大言語モジュール top(Node版)</a></li>
            <li class="breadcrumb-item active"><a href="/voca/<%- lg %>/v/"><%= lang_jp %></a></li>
            <li class="breadcrumb-item active">語彙モジュール</li>
          </ol>
        </nav>
        <%- include('../partials/v_sidebar') %>
        <div class="col main-body">
          <div class="card">
            <div class="card-header">
              <h4 class="card-title">語彙リスト</h4>
            </div>
          </div>
          <div class="row">
            <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
              <ol class="breadcrumb bg-secondary">
                <li class="breadcrumb-item active first-item"><a href="./table">基礎語彙分類表</a></li>
                <li class="breadcrumb-item active"><strong><%= category %></strong></li>
              </ol>
            </nav>
            <div class="row">
              <h5 class="col-6">　id　語彙</h5>
              <h5 class="col-6">取得件数：<span class="c_cand"></span>件</h5>
            </div>
            <div class="result-area container">
              <div class="list-group result-list list-group-flush">
              </div>
            </div><!-- result-area -->
          </div>
        </div>
      </div>
    </main>
    <div class="push"></div>
    <footer><%- include('../partials/footer') %></footer>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="../../js/paginathing.min.js"></script>
    <script type="text/javascript">
      var search_result_list = <%- JSON.stringify(search_result_list) %>;
      $(".c_cand").text(search_result_list.length)
      var i = 1;
      var targetWordIds = []
      for (var item of search_result_list) {
        //$(".result-list").append('<button type="button" data-href="./search_detail" class="list-group-item list-group-item-action"><span class="id">'+i+'.</span><span class="midasi_go" id='+item.word_id+'>'+item.basic+'</span>（'+item.midasi+'）</button>')
        if ("<%= lg %>" === "ar") {
          $(".result-list").addClass("flex-wrap-reverse"); 
          $(".result-list").append('<button type="button" data-href="./search_detail" class="list-group-item list-group-item-action type_ar"><span class="id">'+i+'. </span><span class="midasi_go" id='+item.word_id+'>'+item.basic+'</span>（'+item.hontai+'）</button>')
        } else {
          $(".result-list").addClass("flex-wrap");
          $(".result-list").append('<button type="button" data-href="./search_detail" class="list-group-item list-group-item-action"><span class="id">'+i+'.</span><span class="midasi_go" id='+item.word_id+'>'+item.basic+'</span>（'+item.hontai+'）</button>')
        }
        targetWordIds.push(item.word_id)
        i+=1;
      }
      jQuery(function($){
        $('button[data-href]').addClass('clickable')
        .click(function(e) {
          if(!$(e.target).is('a')){
            var targetWord = "";
            console.log(($(e.target).html()));
            if ($(e.target).html().includes("span")) {
              targetWord = ($(e.target).find('.midasi_go').text());
              targetWordId = ($(e.target).find('.midasi_go').attr('id'));
            } else {
              targetWord = ($(e.target).html());
            }
            console.log(targetWord);
            var url = "./search_detail=<%= chuno %>";
            var targetData = `<input type="hidden" name="category" value="<%= category %>"/><input type="hidden" name="targetWordIds" value="${targetWordIds}"/><input type="hidden" name="targetWord" value="${targetWord}"/>`
            $("body").append('<form action="'+url+'" method="post" id="post">'+targetData+'</form>');
            $("#post").submit();
          };
        });
      });
      //ページネーション
      $(function() {
        $('.result-list').paginathing({//親要素のclassを記述
          perPage: 30,//1ページあたりの表示件数
		      prevText:'前へ',//1つ前のページへ移動するボタンのテキスト
		      nextText:'次へ',//1つ次のページへ移動するボタンのテキスト
		      activeClass: 'navi-active',//現在のページ番号に任意のclassを付与できます
        })
      });
      //スマホ用
      let windowWidth = $(window).width()
      if (windowWidth < 767) {
        $(function(){
          $("#v_sidebar").before($(".main-body"));
        });
      }
    </script>
    <style>
      .id, .c_cand{
        padding-right: 10px;
      }
      .result-list button {
        max-width: 300px;
      }
      @media screen and (min-width: 1200px) {
        .sidebar {
          height: 100%;
        }
        .result-list {
          display: flex;
          flex-wrap: wrap;
          flex-direction: column;
          height: 75vh;
        }
      }
    </style>
  </body>
</html>
